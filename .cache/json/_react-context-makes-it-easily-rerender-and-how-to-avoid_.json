{"data":{"markdownRemark":{"html":"<p>N·∫øu ƒë√£ t·ª´ng s·ª≠ d·ª•ng React context cho d·ª± √°n c·ªßa b·∫°n, v√† g·∫∑p ph·∫£i t√¨nh tr·∫°ng c√°c component con - <strong>Consumer</strong> re-render r·∫•t nhi·ªÅu l·∫ßn, th·∫≠m ch√≠ b·ªã sai logic khi d√πng v·ªõi c√°c th∆∞ vi·ªán UI c√≥ animation, v√† ƒëau ƒë·∫ßu kh√¥ng bi·∫øt l√Ω do t·∫°i sao, l√†m c√°ch n√†o ƒë·ªÉ kh·∫Øc ph·ª•c vi·ªác n√†y, th√¨ h√£y c√πng m√¨nh t√¨m hi·ªÉu b√†i vi·∫øt ng√†y h√¥m nay nh√©.</p>\n<h2>1. S∆° l∆∞·ª£c v·ªÅ useContext.</h2>\n<p>C√πng v·ªõi s·ª± ph√°t tri·ªÉn, ho√†n thi·ªán t·ª´ng ng√†y c·ªßa React th√¨ <strong>React context</strong> API, v√† <strong>useContext</strong> ƒëang d·∫ßn tr·ªü n√™n ph·ªï bi·∫øn v√† r·∫•t ƒë∆∞·ª£c ∆∞a chu·ªông trong c√°c d·ª± √°n c√≥ scope nh·ªè. N·∫øu to√†n b·ªô d·ª± √°n ch·ªâ c√≥ m·ªôt v√†i ng·ªØ c·∫£nh data c·∫ßn truy·ªÅn t·ª´ componentA sang componentB.</p>\n<p>Tr∆∞·ªùng h·ª£p A v√† B c√°ch xa nhau, v√† b·∫°n kh√¥ng mu·ªën pass props t·ª´ component A l√™n component cha, r·ªìi t·ª´ cha xu·ªëng con, ch√°u, ch·∫Øt, ... cu·ªëi c√πng m·ªõi t·ªõi ƒë∆∞·ª£c B (nghƒ© t·ªõi m√¨nh c≈©ng th·∫•y m·ªát ^^).</p>\n<p>V√≠ d·ª• nh∆∞ c√≥ m·ªôt thanh search chung ·ªü tr√™n header, hay side menu, ... v√† b·∫°n mu·ªën ·ªü c√°c component con c≈©ng c√≥ th·ªÉ th·ª±c hi·ªán thao t√°c search,... th√¨ React context l√† m·ªôt s·ª± l·ª±a ch·ªçn tuy·ªát v·ªùi.</p>\n<p>Chi ti·∫øt v·ªÅ vi·ªác s·ª≠ d·ª•ng React context Api, useContext, c√°c b·∫°n c√≥ th·ªÉ tham kh·∫£o ·ªü c√°c b√†i vi·∫øt kh√° hay: <a href=\"https://vntalking.com/su-dung-context-trong-react-theo-cach-don-gian-nhat.html\" rel=\"noopener noreferrer\" target=\"_blank\">S·ª≠ d·ª•ng Context trong React theo c√°ch ƒë∆°n gi·∫£n nh·∫•t</a> - T√°c gi·∫£: <strong>S∆°n D∆∞∆°ng</strong></p>\n<h2>2. C·∫©n th·∫≠n khi d√πng React context</h2>\n<p>Nh∆∞ t·ª´ ƒë·∫ßu b√†i vi·∫øt m√¨nh c√≥ n√≥i ƒë·∫øn vi·ªác React context r·∫•t d·ªÖ g√¢y ra re-render n·∫øu s·ª≠ d·ª•ng kh√¥ng kh√©o l√©o.</p>\n<p>D·∫°o g·∫ßn ƒë√¢y n·∫øu theo d√µi \"k·ªπ s∆∞ m·∫∑t ti·ªÅn\", c√°c b·∫°n ch·∫Øc h·∫≥n ƒë√£ ƒë·ªÉ √Ω m√¨nh c·ª© nhai nh·∫£i vi·ªác re-render ^^.</p>\n<p>Th∆∞·ªùng th√¨ re-render n·∫øu kh√¥ng g√¢y ·∫£nh h∆∞·ªüng m·ªôt c√°ch tr·ª±c quan ƒë·∫øn project th√¨ b·∫°n kh√¥ng c·∫ßn ph·∫£i lo l·∫Øng, nh∆∞ng n·∫øu c√≥ c√°c t√°c v·ª• t√≠nh to√°n v√† animation th√¨ ch√∫ng ta ph·∫£i h·∫øt s·ª©c c·∫©n th·∫≠n.</p>\n<p>X√©t v√≠ d·ª• sau:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-jsx line-numbers\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> useContext<span class=\"token punctuation\">,</span> useState<span class=\"token punctuation\">,</span> createContext <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> React<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> AppContext <span class=\"token operator\">=</span> <span class=\"token function\">createContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">AppProvider</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// bi·∫øn state count n√†y ƒë∆∞·ª£c s·ª≠ d·ª•ng b·ªüi component con</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// message n√†y l√† c·ªë ƒë·ªãnh, kh√¥ng thay ƒë·ªïi</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>message<span class=\"token punctuation\">,</span> setMessage<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">'Message n√†y m√† b·ªã re-render l√† s·∫Ω ƒë·ªïi m√†u'</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> value <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    count<span class=\"token punctuation\">,</span>\n    setCount<span class=\"token punctuation\">,</span>\n    message<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">AppContext.Provider</span></span> <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">}</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">props</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Message</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> message <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>AppContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// m·ªói l·∫ßn b·ªã re-render, ƒëo·∫°n text message s·∫Ω c√≥ m√†u kh√°c nhau</span>\n  <span class=\"token comment\">// gi√∫p ch√∫ng ta d·ªÖ h√¨nh dung</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getColor</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    color<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">rgb(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">getColor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">getColor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">getColor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h4</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>style<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>message<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h4</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Count</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> count<span class=\"token punctuation\">,</span> setCount <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>AppContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h3</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Current count from context: </span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h3</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Increment</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">AppProvider</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Re-renders! üò©</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Message</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Message</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Message</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Count</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">AppProvider</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">,</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>·ªû ƒë√¢y m√¨nh ƒë√£ t·∫°o m·ªôt context t√™n l√† <span class='inline-code'>AppConText</span> bao g·ªìm gi√° tr·ªã bi·∫øn ƒë·∫øm, h√†m set bi·∫øn ƒë·∫øm, v√† n·ªôi dung c·ªßa message.</p>\n<p>B·∫±ng c√°ch l√†m nh∆∞ tr√™n, ƒë·ª©ng ·ªü component con <span class='inline-code'>Count</span>, ta ƒë√£ c√≥ th·ªÉ l·∫•y ƒë∆∞·ª£c gi√° tr·ªã bi·∫øn count, tr·ª±c ti·∫øp set bi·∫øn count, ·ªü component <span class='inline-code'>Message</span> ta c√≥ th·ªÉ l·∫•y ƒë∆∞·ª£c n·ªôi dung <strong>message</strong> truy·ªÅn t·ª´ component cha xu·ªëng <strong>m√† kh√¥ng c·∫ßn pass c√°c props t·ª´ component cha xu·ªëng con</strong>.</p>\n<p>N√≥i c√°ch kh√°c, gi·ªù ƒë√¢y, nh·ªù context, d√π cho component con ƒë·ª©ng ·ªü b·∫•t c·ª© ƒë√¢u, mi·ªÖn l√† n·∫±m trong ph·∫°m vi c·ªßa <strong>Provider</strong>, th√¨ ch√∫ng c√≥ th·ªÉ access ƒë∆∞·ª£c c√°c bi·∫øn kia.</p>\n<p><strong>NH∆ØNG</strong></p>\n<p>Ch·∫°y b·∫£n live-demo b√™n d∆∞·ªõi (b·∫•m tab Result, b·∫•m Run pen), b·∫°n s·∫Ω th·∫•y m·ªôt v·∫•n ƒë·ªÅ r·∫•t l·ªõn, ƒë√≥ l√† <strong>re-render</strong></p>\n<p><strong>M·ªói l·∫ßn b·∫•m n√∫t tƒÉng bi·∫øn ƒë·∫øm, c√°c component <span class='inline-code'>Message</span> b·ªã re-render (ƒë·ªìng nghƒ©a v·ªõi b·ªã ƒë·ªïi m√†u, v√¨ m·ªói l·∫ßn re-render, h√†m <span class='inline-code'>getColor</span> s·∫Ω ƒë∆∞·ª£c ch·∫°y)</strong></p>\n<p><a href=\"https://codepen.io/b-i-kim/pen/LYNmQVe\"><div><iframe \n        height='600' \n        scrolling='no' \n        src='//codepen.io/b-i-kim/embed/preview/LYNmQVe/?height=600&theme-id=dark&default-tab=html,result' \n        frameborder='no' \n        allowtransparency='true' \n        allowfullscreen='true' \n        style='width: 100%;'></iframe></div></a></p>\n<h2>3. Nguy√™n nh√¢n</h2>\n<p>Trong th·∫ø gi·ªõi React context, <strong>t·∫•t c·∫£ component m√† consume (hay useContext, subscribe, s·ª≠ d·ª•ng, l·∫Øng nghe,... b·∫°n d√πng t·ª´ n√†o c≈©ng ƒë∆∞·ª£c) m·ªôt context A, th√¨ to√†n b·ªô component con ƒë√≥ s·∫Ω re-render b·∫•t k·ªÉ khi n√†o context A kia thay ƒë·ªïi, d√π cho context ƒë√≥ kh√¥ng ƒë∆∞·ª£c d√πng ƒë·ªÉ render trong component con.</strong></p>\n<p>X√©t l·∫°i v√≠ d·ª• message ph√≠a tr√™n, <span class='inline-code'>AppContext</span> ch·ª©a 3 gi√° tr·ªã l√†: bi·∫øn state <span class='inline-code'>count</span>, h√†m set gi√° tr·ªã <span class='inline-code'>setCount</span>, v√† cu·ªëi c√πng l√† bi·∫øn state <span class='inline-code'>message</span></p>\n<p>M·ªói khi b·∫•m n√∫t tƒÉng bi·∫øn ƒë·∫øm, bi·∫øn <span class='inline-code'>count</span> thay ƒë·ªïi -> AppContext thay ƒë·ªïi -> component <strong>Message</strong> re-render, m·∫∑c d√π n√≥ kh√¥ng h·ªÅ c√≥ nhu c·∫ßu, v√† c≈©ng kh√¥ng li√™n quan g√¨ ƒë·∫øn vi·ªác tƒÉng gi·∫£m bi·∫øn ƒë·∫øm.</p>\n<p>Ok, ch√∫ng ta ƒë√£ bi·∫øt ƒë∆∞·ª£c nguy√™n nh√¢n, v·∫≠y ƒë√¢u l√† gi·∫£i ph√°p ƒë·ªÉ tr√°nh re-render khi s·ª≠ d·ª•ng React context?</p>\n<h2>4. C√°c c√°ch kh·∫Øc ph·ª•c</h2>\n<p>C√°c <strong>solution</strong> li·ªát k√™ d∆∞·ªõi ƒë√¢y ch√≠nh l√† recommend t·ª´ t√°c gi·∫£ trong ƒë·ªôi ng≈© ph√°t tri·ªÉn React context, anh ·∫•y ƒë√£ comment trong stack overflow, c√°c b·∫°n c√≥ th·ªÉ <a href=\"https://github.com/facebook/react/issues/15156\" rel=\"noopener noreferrer\" target=\"_blank\">xem</a> n·ªôi dung comment g·ªëc n·∫øu mu·ªën.</p>\n<p><span class=\"solution-label\">T√°ch context ra th√†nh nhi·ªÅu context kh√°c nhau</span></p>\n<p>C√°ch ƒë∆∞·ª£c ∆∞a d√πng nh·∫•t l√† <strong>t√°ch nh·ªè context, context n√†o li√™n quan ƒë·∫øn nhau, re-render chung v·ªõi nhau th√¨ ƒëi chung, c√≤n kh√¥ng th√¨ t√°ch ri√™ng</strong></p>\n<p>Thay v√¨ ch·ªâ c√≥ m·ªôt <span class='inline-code'>AppContext</span>, ch√∫ng ta t√°ch ra l√†m 2 context ri√™ng bi·ªát l√† <span class='inline-code'>CounterContext</span> v√† <span class='inline-code'>MessageContext</span></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-jsx line-numbers\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CounterProvider</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Count</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">CounterProvider</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MesageProvider</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Message</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Message</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Message</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">MessageProvider</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  );\n}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Nh∆∞ v·∫≠y, Message component ƒë√£ kh√¥ng c√≤n b·ªã ·∫£nh h∆∞·ªüng b·ªüi vi·ªác tƒÉng bi·∫øn ƒë·∫øm.</p>\n<p><span class=\"solution-label\">D√πng React.memo v√† ch√®n m·ªôt component trung gian v√†o gi·ªØa</span></p>\n<p>N·∫øu b·∫°n ƒëang maintain code v√† kh√¥ng th·ªÉ t√°ch r·ªùi state v√† context nh∆∞ c√°ch tr√™n, th√¨ h√£y th·ª≠ l√†m nh∆∞ sau:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-jsx line-numbers\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> Message <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">memo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getColor</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    color<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">rgb(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">getColor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">getColor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">getColor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h4</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>style<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h4</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">componentWrapper</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>message<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>AppContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Message</span></span> <span class=\"token attr-name\">message</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>message<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">;\n}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>B·∫±ng c√°ch s·ª≠ d·ª•ng React.memo v√† t·∫°o m·ªôt component trung gian, th√¨ d√π cho componentWrapper b·ªã re-render (b·ªüi vi·ªác AppContext change) th√¨ <strong>Message</strong> c·ªßa ch√∫ng ta v·∫´n kh√¥ng b·ªã re-render (v√¨ React.memo nh·∫≠n th·∫•y prop <strong>message</strong>) n√≥ nh·∫≠n v√†o kh√¥ng ƒë·ªïi. Thanks memo!</p>\n<p>M·ªçi t√°c v·ª• render ph·ª©c t·∫°p ƒë·ªÅu n·∫±m ·ªü component <span class='inline-code'>Message</span>, n√™n vi·ªác ·∫£nh h∆∞·ªüng performance t·ª´ vi·ªác rerender ·ªü component trung gian <span class='inline-code'>componentWrapper</span> kh√¥ng c√≤n quan tr·ªçng.</p>\n<p><span class=\"solution-label\">useMemo</span></p>\n<p>C√°ch cu·ªëi c√πng, v√¨ m·ªôt l√Ω do n√†o ƒë√≥ b·∫°n v·∫´n mu·ªën m·ªçi th·ª© ch·ªâ n·∫±m trong m·ªôt component, th√¨ h√£y dung <span class=\"inline-code\">useMemo</span>, wrap ph·∫ßn gi√° tr·ªã tr·∫£ v·ªÅ (return) b√™n trong component ƒë√≥, v·ªõi list c√°c <strong>dependencies</strong> h·ª£p l√Ω.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-jsx line-numbers\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Message</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">props</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> message <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>AppContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token function\">useMemo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getColor</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      color<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">rgb(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">getColor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">getColor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">getColor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h4</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>style<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h4</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>message<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>V·ªõi c√°ch l√†m n√†y, component Message c·ªßa ch√∫ng ta v·∫´n <strong>ch·∫°y l·∫°i</strong> khi <span class='inline-code'>AppContext</span> counter thay ƒë·ªïi, nh∆∞ng React s·∫Ω kh√¥ng render l·∫°i c√°c DOM node c·ªßa compoennt v√¨ dependency <strong>message</strong> truy·ªÅn v√†o <strong>useMemo</strong> l√† gi·ªëng nhau.</p>\n<h2>5. K·∫øt lu·∫≠n</h2>\n<p>Hy v·ªçng qua b√†i vi·∫øt n√†y, c√°c b·∫°n ƒë√£ bi·∫øt ƒë·∫øn v·∫•n ƒë·ªÅ re-render t·ªìn t·∫°i v·ªõi React context v√† c√°ch x·ª≠ l√Ω hi·ªáu qu·∫£.</p>\n<p>C√πng comment ph√≠a d∆∞·ªõi n·∫øu b·∫°n c√≤n bi·∫øt c√°ch n√†o kh√°c hi·ªáu qu·∫£ n·ªØa nha.</p>\n<p>Th·∫•y hay th√¨ cho m√¨nh m·ªôt like nh√©, h·∫πn g·∫∑p c√°c b·∫°n trong c√°c b√†i vi·∫øt ti·∫øp theo.</p>\n<p>M·∫øn ch√†o c√°c b·∫°n!</p>\n<h2>6. Ngu·ªìn v√† b√†i vi·∫øt hay li√™n quan</h2>\n<p><a href=\"https://github.com/facebook/react/issues/15156\">React context issue</a></p>\n<p><a href=\"https://blog.axlight.com/posts/4-options-to-prevent-extra-rerenders-with-react-context/#:~:text=If%20the%20size%20of%20your,This%20is%20by%20design.\">4 options to prevent extra rerenders with React context</a> - T√°c gi·∫£: Daishi Kato</p>\n<p><a href=\"https://vntalking.com/su-dung-context-trong-react-theo-cach-don-gian-nhat.html\" rel=\"noopener noreferrer\" target=\"_blank\">S·ª≠ d·ª•ng Context trong React theo c√°ch ƒë∆°n gi·∫£n nh·∫•t</a> - T√°c gi·∫£: S∆°n D∆∞∆°ng</p>","featuredImg":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIEBQP/xAAWAQEBAQAAAAAAAAAAAAAAAAACAwH/2gAMAwEAAhADEAAAAchz0Lwz1lipzCoAr//EABsQAAIDAAMAAAAAAAAAAAAAAAABAgMRBBAx/9oACAEBAAEFAorTH3XejkYrCLyXp//EABkRAAIDAQAAAAAAAAAAAAAAAAERAAIxEP/aAAgBAwEBPwGzGSpYcOc//8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAQ/9oACAECAQE/ASYz/8QAGhAAAgIDAAAAAAAAAAAAAAAAAAERMRAgcf/aAAgBAQAGPwIrMNRwvT//xAAaEAEAAgMBAAAAAAAAAAAAAAABABEhQXEQ/9oACAEBAAE/IcmtTBdq5GDUQHcyg4XjAmoqrW2f/9oADAMBAAIAAwAAABCLwEL/xAAZEQADAAMAAAAAAAAAAAAAAAAAAREQMVH/2gAIAQMBAT8QddSkfo3Y/8QAGREBAAIDAAAAAAAAAAAAAAAAAQAhEBEx/9oACAECAQE/EGNLKOp0Y//EAB4QAQEBAAEEAwAAAAAAAAAAAAERADEhUWFxgZHR/9oACAEBAAE/EEHSovXL/PqmCMSPnco+si1HFBPXOeAxSp2/NXRetJfWuF3Fu//Z","aspectRatio":1.0049019607843137,"src":"/static/b3143b481522c41b1d1ba438c6fd27e0/8f023/YMFT5D7.jpg","srcSet":"/static/b3143b481522c41b1d1ba438c6fd27e0/547bc/YMFT5D7.jpg 205w,\n/static/b3143b481522c41b1d1ba438c6fd27e0/fb51d/YMFT5D7.jpg 410w,\n/static/b3143b481522c41b1d1ba438c6fd27e0/8f023/YMFT5D7.jpg 820w,\n/static/b3143b481522c41b1d1ba438c6fd27e0/76e75/YMFT5D7.jpg 1230w,\n/static/b3143b481522c41b1d1ba438c6fd27e0/ff2e5/YMFT5D7.jpg 1640w,\n/static/b3143b481522c41b1d1ba438c6fd27e0/0d7b7/YMFT5D7.jpg 2326w","sizes":"(max-width: 820px) 100vw, 820px"}}},"frontmatter":{"title":"3 c√°ch ƒë·ªÉ tr√°nh re-render khi d√πng React context","featuredImgAlt":"3 c√°ch ƒë·ªÉ tr√°nh re-render khi d√πng React context","featuredImgUrl":"https://i.imgur.com/YMFT5D7.jpg?1","description":"H·∫≥n n·∫øu ƒë√£ t·ª´ng m√†y m√≤ s·ª≠ d·ª•ng React context, b·∫°n ƒë√£ t·ª´ng ƒëau ƒë·∫ßu v√† kh√¥ng bi·∫øt t·∫°i sao component b·ªã re-render r·∫•t nhi·ªÅu l·∫ßn. Trong b√†i vi·∫øt h√¥m nay, ch√∫ng ta c√πng nhau ƒëi t√¨m hi·ªÉu nguy√™n nh√¢n v√† t√¨m c√°ch kh·∫Øc ph·ª•c nh√©!","author":{"name":"Thi√™n B√πi"},"date":"2020-09-10"}}},"pageContext":{"slug":"/react-context-makes-it-easily-rerender-and-how-to-avoid/","previous":{"fields":{"slug":"/how-english-would-help-you/"},"frontmatter":{"title":"Ti·∫øng Anh s·∫Ω gi√∫p √≠ch cho con ƒë∆∞·ªùng h·ªçc l·∫≠p tr√¨nh web c·ªßa b·∫°n. Chia s·∫ª t·ª´ m·ªôt ng∆∞·ªùi t·ª´ 0 ƒë·∫øn 870 ƒëi·ªÉm TOEIC"}},"next":{"fields":{"slug":"/the-ultimate-guide-about-useMemo-and-useCallback/"},"frontmatter":{"title":"T·∫•t t·∫ßn t·∫≠t v·ªÅ useMemo v√† useCallback"}}}}